<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Quote Notes</title>
    <style>
        :root {
            --bg-color: #d1d1d1;
            --text-color: #333;
            --form-bg: #f0f0f0;
            --header-color: #2c3e50;
            --subtitle-color: #7f8c8d;
            --output-bg: #2c3e50;
            --output-hover: #34495e;
            --output-active: #1a252f;
            --copy-notice-color: #bdc3c7;
            --required-color: #e74c3c;
            --disclaimer-color: #7f8c8d;
        }

        .dark-mode {
            --bg-color: #1a1a1a;
            --text-color: #f0f0f0;
            --form-bg: #2d2d2d;
            --header-color: #3498db;
            --subtitle-color: #95a5a6;
            --output-bg: #3498db;
            --output-hover: #2980b9;
            --output-active: #1c5a7d;
            --copy-notice-color: #bdc3c7;
            --required-color: #e74c3c;
            --disclaimer-color: #95a5a6;
        }

        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
            position: relative;
        }
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        h1 {
            color: var(--header-color);
            margin-bottom: 5px;
        }
        .subtitle {
            color: var(--subtitle-color);
            font-style: italic;
        }
        .form-section {
            background-color: var(--form-bg);
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            margin-left: 0;
        }
        .form-group {
            margin-bottom: 10px;
            justify-content: center;
            font-size: 15px;
        }
        label {
            display: block;
            margin-bottom: 3px;
            font-size: 14px;
            font-weight: 600;
        }
        input[type="text"] {
            width: 100%;
            padding: 7px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            background-color: var(--form-bg);
            color: var(--text-color);
        }
        input[type="date"] {
            width: 95%;
            padding: 7px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            background-color: var(--form-bg);
            color: var(--text-color);
            justify-content: space-evenly;
        }
        input[type="checkbox"] {
            margin-right: 10px;
            margin-left: 20px
            transform: scale(2.0);
        }
        .output-section {
            background-color: var(--output-bg);
            color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 20px;
        }
        .output-section:hover {
            background-color: var(--output-hover);
        }
        .output-section:active {
            background-color: var(--output-active);
        }
        .output-text {
            white-space: pre-line;
            line-height: 1.5;
            font-size: 18px;
        }
        .copy-notice {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: var(--copy-notice-color);
        }
        .checkbox-group {
            display: grid;
            align-items: center;
        }
        .required {
            color: var(--required-color);
        }
        .disclaimer {
            text-align: center;
            color: var(--disclaimer-color);
            font-size: 14px;
            margin-top: 10px;
            margin-bottom: 10px;
            font-style: italic;
        }
        
        /* Inline form group styling */
        .inline-form-group {
            display: flex;
            flex-wrap: nowrap;
            gap: 10px;
            align-items: stretch;
            justify-content: space-between;
        }
        .inline-form-group .form-group {
            margin-bottom: 5px;
            flex: 1;
            min-width: 100px;
        }
        .inline-form-group .checkbox-group {
            margin-top: 20px;
            margin-left: 0px;
            display: grid;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        /* Dark mode toggle button */
        #darkModeToggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--header-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: background-color 0.3s;
        }
        #darkModeToggle:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <button id="darkModeToggle">☀︎</button>
    
    <header>
        <h1>Quick Quote Notes</h1>
        <p class="subtitle">Complete the form to generate copy text.</p>
    </header>

    <section class="form-section">
        <div class="form-group">
            <label for="author">Author: <span class="required">*</span></label>
            <input type="text" id="author" placeholder="Enter author name">
        </div>
        
        <div class="form-group">
            <label for="quoteTotal">Quote Total (after taxes, etc.): <span class="required">*</span></label>
            <input type="text" id="quoteTotal" placeholder="Enter amount">
        </div>

        <div class="form-group">
            <label for="expiration">Expiration Date: <span class="required">*</span></label>
            <input type="date" id="expiration">
        </div>
        
        <!-- Inline form group for discount, hero, and financing -->
        <div class="inline-form-group">
            <div class="form-group">
                <label for="discount">Discount:</label>
                <input type="text" id="discount" placeholder="Enter %">%
            </div>
            
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="hero">
                    <label for="hero">Hero?</label>
                </div>
            </div>
            
            <div class="form-group">
                <label for="financing">Financing:</label>
                <input type="text" id="financing" placeholder="Enter months" value="24"> months
            </div>
        </div>
        
        <div class="form-group">
            <label for="customNote">Custom Note:</label>
            <input type="text" id="customNote" placeholder="Enter custom note">
        </div>
    </section>

    <section class="output-section" id="outputSection">
        <div class="output-text" id="outputText">Please fill in the required fields to generate the quote text.</div>
        <div class="copy-notice">Click to copy to clipboard</div>
    </section>
    
    <div class="disclaimer">- ver. 1.1.1 -</div>
    <div class="disclaimer">Not affiliated with Lovesac. For demonstration purposes only.</div>

    <script>
        // Get DOM elements
        const authorInput = document.getElementById('author');
        const quoteTotalInput = document.getElementById('quoteTotal');
        const discountInput = document.getElementById('discount');
        const heroCheckbox = document.getElementById('hero');
        const financingInput = document.getElementById('financing');
        const expirationInput = document.getElementById('expiration');
        const customNoteInput = document.getElementById('customNote');
        const outputText = document.getElementById('outputText');
        const outputSection = document.getElementById('outputSection');
        const darkModeToggle = document.getElementById('darkModeToggle');

        // Format number as currency
        function formatCurrency(amount) {
            return parseFloat(amount).toLocaleString('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        // Calculate days until expiration
        function getDaysUntilExpiration(expirationDate) {
            const today = new Date();
            today.setHours(4, 0, 0, 0); // Set to beginning of day for accurate day count
            
            const expDate = new Date(expirationDate);
            expDate.setHours(20, 0, 0, 0); // Set to beginning of day for accurate day count
            
            const diffTime = expDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        // Format today's date
        function getFormattedToday() {
            const today = new Date();
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const dayName = days[today.getDay()];
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const year = String(today.getFullYear()).slice(-2);
            return `${dayName}. ${month}/${day}/${year}`;
        }

        // Calculate monthly payment (without applying discount)
        function calculateMonthlyPayment(total, months) {
            return Math.ceil(total / months);
        }

        // Format date as MM/DD/YY
        function formatDate(dateString) {
            const date = new Date(dateString);
            // Add timezone offset to prevent date shifting
            const timezoneOffset = date.getTimezoneOffset() * 60000;
            const adjustedDate = new Date(date.getTime() + timezoneOffset);
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const dayName = days[adjustedDate.getDay()];
            const month = adjustedDate.getMonth() + 1;
            const day = adjustedDate.getDate();
            return `${dayName}. ${month}/${day}`;
        }

        // Update output text
        function updateOutput() {
            const author = authorInput.value || '';
            const quoteTotal = parseFloat(quoteTotalInput.value) || 0;
            const discount = parseFloat(discountInput.value) || 0;
            const isHero = heroCheckbox.checked;
            const financing = parseInt(financingInput.value) || 0;
            const expirationDate = expirationInput.value;
            const customNote = customNoteInput.value;
            
            // Check if required fields are filled
            if (!author || !quoteTotal || !expirationDate) {
                outputText.textContent = 'Please fill in the required fields to generate the quote text.';
                return;
            }
            
            // Calculate values
            const monthlyPayment = financing > 0 ? calculateMonthlyPayment(quoteTotal, financing) : 0;
            const daysUntilExpiration = getDaysUntilExpiration(expirationDate);
            const todayFormatted = getFormattedToday();
            const formattedExpDate = formatDate(expirationDate);
            
            // Build output text
            let output = '';
            
            // Custom note if provided
            if (customNote) {
                output += `(${customNote}) `;
            }
            
            // Price section
            output += `{ ${formatCurrency(quoteTotal)}`;
            
            // Add monthly payment if financing is specified
            if (financing > 0) {
                output += ` or $${monthlyPayment} per mo. for ${financing} mos.`;
            }
            
            // Add discount if specified
            if (discount > 0) {
                output += ` after ${discount}% off`;
            }
            
            // Add Heroes Code if checked
            if (isHero) {
                output += ' with Heroes Code**';
            }
            
            output += ' }   ';
            
    // Expiration section - UPDATED based on days until expiration
    let expirationMessage = '';
    if (daysUntilExpiration === 0) {
        expirationMessage = `....EXPIRES TODAY, ${formattedExpDate}....`;
    } else if (daysUntilExpiration === 1) {
        expirationMessage = `....EXPIRES TOMORROW, ${formattedExpDate}....`;
    } else {
        expirationMessage = `....EXPIRES in ${daysUntilExpiration} days on ${formattedExpDate}....`;
    }
    output += expirationMessage + '   ';
            
            // Heroes message if checked
            if (isHero) {
                output += ' **Visit LOVESAC.COM/HEROES to apply!   ';
            }
            
            // Author & Date
            output += `–by ${author} on ${todayFormatted}–`;
            
            outputText.textContent = output;
        }

        // Copy to clipboard functionality
        outputSection.addEventListener('click', function() {
            const textToCopy = outputText.textContent;
            
            // Don't copy if it's the placeholder text
            if (textToCopy.includes('Please fill in')) {
                return;
            }
            
            // Create a temporary textarea element to copy from
            const textarea = document.createElement('textarea');
            textarea.value = textToCopy;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            
            // Show visual feedback
            const originalText = outputSection.querySelector('.copy-notice').textContent;
            outputSection.querySelector('.copy-notice').textContent = 'Copied to clipboard!';
            
            setTimeout(() => {
                outputSection.querySelector('.copy-notice').textContent = originalText;
            }, 2000);
        });

        // Add event listeners for live updates
        const inputs = [authorInput, quoteTotalInput, discountInput, heroCheckbox, 
                       financingInput, expirationInput, customNoteInput];
        
        inputs.forEach(input => {
            if (input.type === 'checkbox') {
                input.addEventListener('change', updateOutput);
            } else {
                input.addEventListener('input', updateOutput);
            }
        });

        // Dark mode toggle functionality
        darkModeToggle.addEventListener('click', function() {
            document.body.classList.toggle('dark-mode');
            
            if (document.body.classList.contains('dark-mode')) {
                darkModeToggle.textContent = '⏾';
            } else {
                darkModeToggle.textContent = '☀︎';
            }
        });

        // Initial update
        updateOutput();
    </script>
</body>
</html>
